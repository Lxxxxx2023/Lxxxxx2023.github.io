import{k as ge,m as ie,r as A,e as Ce,s as Ee,f as O,w as le,q as Ne,M as ce,N as P,X as h,v as f,ac as Oe,Q as I,V as ue,P as p,x as n,R as V,O as U,W as te,ad as Re,F as fe,Y as Le,S as ze,an as Se,U as $e,Z as Me,$ as Ae,n as Pe}from"./framework.BBlErx2S.js";import{P as Ve,Q as Z,R as Xe,J as de,z as Ye,H as me,I as Be,A as De,S as Fe,T as We,K as He,B as Ke,U as Ue,N as B,V as Ze,E as R,C as je,W as qe,X as Qe,Y as Ge,Z as Je,$ as et,a0 as tt,a1 as nt,a2 as X,D as at}from"./app.C-a7vcDG.js";var st=/\s/;function rt(t){for(var o=t.length;o--&&st.test(t.charAt(o)););return o}var ot=/^\s+/;function it(t){return t&&t.slice(0,rt(t)+1).replace(ot,"")}var ve=NaN,lt=/^[-+]0x[0-9a-f]+$/i,ct=/^0b[01]+$/i,ut=/^0o[0-7]+$/i,ft=parseInt;function pe(t){if(typeof t=="number")return t;if(Ve(t))return ve;if(Z(t)){var o=typeof t.valueOf=="function"?t.valueOf():t;t=Z(o)?o+"":o}if(typeof t!="string")return t===0?t:+t;t=it(t);var c=ct.test(t);return c||ut.test(t)?ft(t.slice(2),c?2:8):lt.test(t)?ve:+t}var ne=function(){return Xe.Date.now()},dt="Expected a function",mt=Math.max,vt=Math.min;function pt(t,o,c){var m,a,b,k,d,x,s=0,D=!1,T=!1,S=!0;if(typeof t!="function")throw new TypeError(dt);o=pe(o)||0,Z(c)&&(D=!!c.leading,T="maxWait"in c,b=T?mt(pe(c.maxWait)||0,o):b,S="trailing"in c?!!c.trailing:S);function $(i){var _=m,z=a;return m=a=void 0,s=i,k=t.apply(z,_),k}function C(i){return s=i,d=setTimeout(r,o),D?$(i):k}function v(i){var _=i-x,z=i-s,H=o-_;return T?vt(H,b-z):H}function L(i){var _=i-x,z=i-s;return x===void 0||_>=o||_<0||T&&z>=b}function r(){var i=ne();if(L(i))return F(i);d=setTimeout(r,v(i))}function F(i){return d=void 0,S&&m?$(i):(m=a=void 0,k)}function j(){d!==void 0&&clearTimeout(d),s=0,m=x=a=d=void 0}function W(){return d===void 0?k:F(ne())}function M(){var i=ne(),_=L(i);if(m=arguments,a=this,x=i,_){if(d===void 0)return C(x);if(T)return clearTimeout(d),d=setTimeout(r,o),$(x)}return d===void 0&&(d=setTimeout(r,o)),k}return M.cancel=j,M.flush=W,M}var gt="Expected a function";function ae(t,o,c){var m=!0,a=!0;if(typeof t!="function")throw new TypeError(gt);return Z(c)&&(m="leading"in c?!!c.leading:m,a="trailing"in c?!!c.trailing:a),pt(t,o,{leading:m,maxWait:o,trailing:a})}const ht=t=>Object.keys(t),bt=Ye({urlList:{type:me(Array),default:()=>Be([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:me(String)}}),kt={close:()=>!0,switch:t=>de(t),rotate:t=>de(t)},_t=ge({name:"ElImageViewer"}),wt=ge({..._t,props:bt,emits:kt,setup(t,{expose:o,emit:c}){var m;const a=t,b={CONTAIN:{name:"contain",icon:ie(We)},ORIGINAL:{name:"original",icon:ie(Fe)}};let k,d="";const{t:x}=He(),s=Ke("image-viewer"),{nextZIndex:D}=Ue(),T=A(),S=A([]),$=Ce(),C=A(!0),v=A(a.initialIndex),L=Ee(b.CONTAIN),r=A({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),F=A((m=a.zIndex)!=null?m:D()),j=O(()=>{const{urlList:e}=a;return e.length<=1}),W=O(()=>v.value===0),M=O(()=>v.value===a.urlList.length-1),i=O(()=>a.urlList[v.value]),_=O(()=>[s.e("btn"),s.e("prev"),s.is("disabled",!a.infinite&&W.value)]),z=O(()=>[s.e("btn"),s.e("next"),s.is("disabled",!a.infinite&&M.value)]),H=O(()=>{const{scale:e,deg:u,offsetX:l,offsetY:g,enableTransition:w}=r.value;let y=l/e,N=g/e;const Y=u*Math.PI/180,re=Math.cos(Y),oe=Math.sin(Y);y=y*re+N*oe,N=N*re-l/e*oe;const ee={transform:`scale(${e}) rotate(${u}deg) translate(${y}px, ${N}px)`,transition:w?"transform .3s":""};return L.value.name===b.CONTAIN.name&&(ee.maxWidth=ee.maxHeight="100%"),ee}),he=O(()=>`${v.value+1} / ${a.urlList.length}`);function K(){ke(),k==null||k(),document.body.style.overflow=d,c("close")}function be(){const e=ae(l=>{switch(l.code){case X.esc:a.closeOnPressEscape&&K();break;case X.space:q();break;case X.left:G();break;case X.up:E("zoomIn");break;case X.right:J();break;case X.down:E("zoomOut");break}}),u=ae(l=>{const g=l.deltaY||l.deltaX;E(g<0?"zoomIn":"zoomOut",{zoomRate:a.zoomRate,enableTransition:!1})});$.run(()=>{B(document,"keydown",e),B(document,"wheel",u)})}function ke(){$.stop()}function _e(){C.value=!1}function we(e){C.value=!1,e.target.alt=x("el.image.error")}function ye(e){if(C.value||e.button!==0||!T.value)return;r.value.enableTransition=!1;const{offsetX:u,offsetY:l}=r.value,g=e.pageX,w=e.pageY,y=ae(Y=>{r.value={...r.value,offsetX:u+Y.pageX-g,offsetY:l+Y.pageY-w}}),N=B(document,"mousemove",y);B(document,"mouseup",()=>{N()}),e.preventDefault()}function se(){r.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function q(){if(C.value)return;const e=ht(b),u=Object.values(b),l=L.value.name,w=(u.findIndex(y=>y.name===l)+1)%e.length;L.value=b[e[w]],se()}function Q(e){const u=a.urlList.length;v.value=(e+u)%u}function G(){W.value&&!a.infinite||Q(v.value-1)}function J(){M.value&&!a.infinite||Q(v.value+1)}function E(e,u={}){if(C.value)return;const{minScale:l,maxScale:g}=a,{zoomRate:w,rotateDeg:y,enableTransition:N}={zoomRate:a.zoomRate,rotateDeg:90,enableTransition:!0,...u};switch(e){case"zoomOut":r.value.scale>l&&(r.value.scale=Number.parseFloat((r.value.scale/w).toFixed(3)));break;case"zoomIn":r.value.scale<g&&(r.value.scale=Number.parseFloat((r.value.scale*w).toFixed(3)));break;case"clockwise":r.value.deg+=y,c("rotate",r.value.deg);break;case"anticlockwise":r.value.deg-=y,c("rotate",r.value.deg);break}r.value.enableTransition=N}function Ie(e){var u;((u=e.detail)==null?void 0:u.focusReason)==="pointer"&&e.preventDefault()}function xe(){a.closeOnPressEscape&&K()}function Te(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}return le(i,()=>{Pe(()=>{const e=S.value[0];e!=null&&e.complete||(C.value=!0)})}),le(v,e=>{se(),c("switch",e)}),Ne(()=>{be(),k=B("wheel",Te,{passive:!1}),d=document.body.style.overflow,document.body.style.overflow="hidden"}),o({setActiveItem:Q}),(e,u)=>(P(),ce(n(nt),{to:"body",disabled:!e.teleported},{default:h(()=>[f(Oe,{name:"viewer-fade",appear:""},{default:h(()=>[I("div",{ref_key:"wrapper",ref:T,tabindex:-1,class:p(n(s).e("wrapper")),style:ue({zIndex:F.value})},[f(n(Ze),{loop:"",trapped:"","focus-trap-el":T.value,"focus-start-el":"container",onFocusoutPrevented:Ie,onReleaseRequested:xe},{default:h(()=>[I("div",{class:p(n(s).e("mask")),onClick:Re(l=>e.hideOnClickModal&&K(),["self"])},null,10,["onClick"]),V(" CLOSE "),I("span",{class:p([n(s).e("btn"),n(s).e("close")]),onClick:K},[f(n(R),null,{default:h(()=>[f(n(je))]),_:1})],2),V(" ARROW "),n(j)?V("v-if",!0):(P(),U(fe,{key:0},[I("span",{class:p(n(_)),onClick:G},[f(n(R),null,{default:h(()=>[f(n(qe))]),_:1})],2),I("span",{class:p(n(z)),onClick:J},[f(n(R),null,{default:h(()=>[f(n(Qe))]),_:1})],2)],64)),e.showProgress?(P(),U("div",{key:1,class:p([n(s).e("btn"),n(s).e("progress")])},[te(e.$slots,"progress",{activeIndex:v.value,total:e.urlList.length},()=>[Le(ze(n(he)),1)])],2)):V("v-if",!0),V(" ACTIONS "),I("div",{class:p([n(s).e("btn"),n(s).e("actions")])},[I("div",{class:p(n(s).e("actions__inner"))},[te(e.$slots,"toolbar",{actions:E,prev:G,next:J,reset:q,activeIndex:v.value},()=>[f(n(R),{onClick:l=>E("zoomOut")},{default:h(()=>[f(n(Ge))]),_:1},8,["onClick"]),f(n(R),{onClick:l=>E("zoomIn")},{default:h(()=>[f(n(Je))]),_:1},8,["onClick"]),I("i",{class:p(n(s).e("actions__divider"))},null,2),f(n(R),{onClick:q},{default:h(()=>[(P(),ce(Se(n(L).icon)))]),_:1}),I("i",{class:p(n(s).e("actions__divider"))},null,2),f(n(R),{onClick:l=>E("anticlockwise")},{default:h(()=>[f(n(et))]),_:1},8,["onClick"]),f(n(R),{onClick:l=>E("clockwise")},{default:h(()=>[f(n(tt))]),_:1},8,["onClick"])])],2)],2),V(" CANVAS "),I("div",{class:p(n(s).e("canvas"))},[(P(!0),U(fe,null,$e(e.urlList,(l,g)=>Me((P(),U("img",{ref_for:!0,ref:w=>S.value[g]=w,key:l,src:l,style:ue(n(H)),class:p(n(s).e("img")),crossorigin:e.crossorigin,onLoad:_e,onError:we,onMousedown:ye},null,46,["src","crossorigin"])),[[Ae,g===v.value]])),128))],2),te(e.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var yt=De(wt,[["__file","image-viewer.vue"]]);const Tt=at(yt);export{Tt as E,bt as i};
